C51 COMPILER V9.54   UART                                                                  09/08/2017 16:50:39 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE UART
OBJECT MODULE PLACED IN .\uart.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\HARDWARE\Uart\uart.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(..\delay;.
                    -.\HARDWARE\pca;..\MAIN;..\HARDWARE\Uart) DEBUG OBJECTEXTEND PRINT(.\uart.lst) TABS(2) OBJECT(.\uart.obj)

line level    source

   1          
   2          
   3          #include "uart.h"
   4          
   5          
   6          void UartInit(void)   
   7          {
   8   1             SCON=0x50;        
   9   1           TMOD= 0x00;                      
  10   1           AUXR=0X40;    
  11   1             TL1=(65535-(11059200/4/9600));    
  12   1           TH1=(65535-(11059200/4/9600))>>8;
  13   1           TR1  = 1;        
  14   1           ES   = 1;                                                                            
  15   1           EA   = 1;          
  16   1        
  17   1      }
  18          
  19          void UartSendByte(u8 dat)
  20          {
  21   1        SBUF = dat;
  22   1        while(TI == 0);
  23   1        TI = 0;
  24   1      }
  25          
  26          void UartSendStr(u8 *str)
  27          {
  28   1        while(*str)
  29   1        {
  30   2          UartSendByte(*str);
  31   2          str++;
  32   2        }
  33   1      }
  34          
  35          void UartSend(u8 *str ,u8 len)
  36          {
  37   1        while(len--)
  38   1        {
  39   2          UartSendByte(*str);
  40   2          str++;
  41   2        }
  42   1      }
  43          
  44          
  45          //更新PWM占空比
  46          void Setup_pwm(u8 sbufp)
  47          {
  48   1      
  49   1        CCAP0H=CCAP0L=sbufp;       //更新PWM占空比
  50   1      
  51   1        UartSendStr("ok\r\n");
  52   1      
  53   1      }
  54          
C51 COMPILER V9.54   UART                                                                  09/08/2017 16:50:39 PAGE 2   

  55          
  56          /*****************************************************************************/
  57               
  58          
  59          
  60          void UART0_Interrupt(void) interrupt 4 using 1
  61          {
  62   1        u8 SbufTemp;
  63   1        
  64   1        if(RI)
  65   1        {
  66   2          RI = 0;
  67   2          SbufTemp = SBUF;
  68   2      
  69   2            Setup_pwm(SbufTemp);
  70   2        }
  71   1      }
  72          
  73           
  74          
  75          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    115    ----
   CONSTANT SIZE    =      5    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
